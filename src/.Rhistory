newdata
nfit = 153
newdata = data.frame(x=time.pts[(nfit+1):n])
gam.pred= predict(gam.fit.tr,newdata = newdata)
predict(gam.fit.tr)
predict(gam.fit.tr,newdata=newdata)
newdata
time.pts = c(1:length(hosr[,"hosr"]))
time.pts = c(time.pts - min(time.pts))/max(time.pts)
x <- time.pts[1:153]
gam.fit.tr = gam(training[,"hosr"]~s(x))
hosr.fit.gam = fitted(gam.fit.tr)
hosr.fit.gam = ts(hosr.fit.gam,start=1980, freq=4)
resid.process = training[,"hosr"]-hosr.fit.gam
resid.process = ts(resid.process,start=1980, freq=4)
par(mfrow=c(2,2))
plot(ts_hosr,xlab="Years",ylab="Home ownership rate",type="l")
lines(hosr.fit.gam,lwd=2,col="blue")
plot(resid.process,xlab="Years",ylab="De-Trended Time Series",type="l")
acf(resid.process,main="ACF: De-trended TS")
pacf(resid.process,main="PACF: De-trended TS")
nfit = 153
newdata = data.frame(x=time.pts[(nfit+1):n])
gam.pred= predict(gam.fit.tr,newdata = newdata,interval=c("prediction"))
outpredresid = predict(final_model.1,n.ahead=15)$pred
## Add up the predictions
final.pred.1 = outpredresid+gam.pred
final.pred.1
final.pred.2 = predict(final_model.2,n.ahead=15)$pred
final.pred.2
final.pred.3a = forecast(model.var,h=15)
model.var
final.pred.3b = forecast(model.var.restrict,h=15)
final.pred.3a = forecast(model.var,n.ahead=15)
forecast(model.var,n.ahead=15)
final.pred.3a = predict(model.var,n.ahead=15)
final.pred.3b = forecast(model.var.restrict,n.ahead=15)
final.pred.3a = predict(model.var,n.ahead=15)
final.pred.3b = predict(model.var.restrict,n.ahead=15)
final.pred.3a
final.pred.3a = predict(model.var,n.ahead=15)$ts_hosr
final.pred.3b = predict(model.var.restrict,n.ahead=15)$ts_hosr
final.pred.3a
final.pred.3a = predict(model.var,n.ahead=15)
final.pred.3a = predict(model.var,n.ahead=15)$fcst$ts_hosr
final.pred.3b = predict(model.var.restrict,n.ahead=15)$fcst$ts_hosr
final.pred.3a
final.pred.3a[1]
final.pred.3a[1,]
final.pred.3a[,1]
final.pred.4a = predict(model.var2,n.ahead=15)$fcst$ts_hosr
x = data.frame(ts_umcsent[154:168],ts_unrate[154:168])
final.pred.4a = predict(model.var2,n.ahead=15,dumvar=x)$fcst$ts_hosr
x = data.frame(ts_umcsent[154:168],ts_unrate[154:168])
final.pred.4a = predict(model.var2,n.ahead=15,dumvar=data.frame(ts_umcsent[154:168],ts_unrate[154:168]))$fcst$ts_hosr
model.var2
x
data.frame(umcsent=ts_umcsent[1:153],unrate=ts_unrate[1:153])
## Model Fitting: Unrestricted VAR
model.var2=VAR(cbind(ts_hosr[1:153],ts_permit[1:153]), p=1,exogen=data.frame(umcsent=ts_umcsent[1:153],unrate=ts_unrate[1:153]))
summary(model.var2)
## Model Fitting: Restricted VAR
model.var.restrict2=restrict(model.var2)
summary(model.var.restrict2)
x = data.frame(umcsent=ts_umcsent[154:168],unrate=ts_unrate[154:168])
final.pred.4a = predict(model.var2,n.ahead=15,dumvar=x)$fcst$ts_hosr
final.pred.4b = predict(model.var.restrict2,n.ahead=15,dumvar=x)$fcst$ts_hosr
final.pred.4a
predict(model.var2,n.ahead=15,dumvar=x)
x = data.frame(umcsent=ts_umcsent[154:168],unrate=ts_unrate[154:168])
final.pred.4a = predict(model.var2,n.ahead=15,dumvar=x)$fcst$y1
final.pred.4b = predict(model.var.restrict2,n.ahead=15,dumvar=x)$fcst$y1
final.pred.4a
ts.plot(ts_hosr)
final.pred.1
ts.plot(ts_hosr)
line(final.pred.1)
ts.plot(ts_hosr)
points(final.pred.1)
final.pred.2
final.pred.3a[,1]
ts.plot(ts_hosr,main="All Forecasts",ylab="homeownership rate")
points(final.pred.1,lwd=2,col="red")
points(final.pred.2,lwd=2,col="orange")
points(ts(final.pred.3a[,1],start=154),lwd=2,col="blue")
points(ts(final.pred.3b[,1],start=154),lwd=2,col="lightblue")
points(ts(final.pred.41[,1],start=154),lwd=2,col="green")
ts.plot(ts_hosr,main="All Forecasts",ylab="homeownership rate")
points(final.pred.1,lwd=2,col="red")
points(final.pred.2,lwd=2,col="orange")
points(ts(final.pred.3a[,1],start=154),lwd=2,col="blue")
points(ts(final.pred.3b[,1],start=154),lwd=2,col="lightblue")
points(ts(final.pred.4a[,1],start=154),lwd=2,col="green")
points(ts(final.pred.4b[,1],start=154),lwd=2,col="lightgreen")
legend(x=1,y=425,legend=c("model1","model2","model3","model4","model5","model6"),pch=1,
pt.lwd = 2, col=c("red","orange","blue","light","green","lightgreen"))
ts.plot(ts_hosr,main="All Forecasts",ylab="homeownership rate")
points(final.pred.1,lwd=2,col="red")
points(final.pred.2,lwd=2,col="orange")
points(ts(final.pred.3a[,1],start=154),lwd=2,col="blue")
points(ts(final.pred.3b[,1],start=154),lwd=2,col="lightblue")
points(ts(final.pred.4a[,1],start=154),lwd=2,col="darkgreen")
points(ts(final.pred.4b[,1],start=154),lwd=2,col="green")
legend(x=1,y=425,legend=c("model1","model2","model3","model4","model5","model6"),pch=1,
pt.lwd = 2, col=c("red","orange","blue","light","darkgreen","green"))
ts.plot(ts_hosr,main="All Forecasts",ylab="homeownership rate")
points(final.pred.1,lwd=2,col="red")
points(final.pred.2,lwd=2,col="orange")
points(ts(final.pred.3a[,1],start=154),lwd=2,col="blue")
points(ts(final.pred.3b[,1],start=154),lwd=2,col="lightblue")
points(ts(final.pred.4a[,1],start=154),lwd=2,col="darkgreen")
points(ts(final.pred.4b[,1],start=154),lwd=2,col="green")
legend(x=1,y=425,legend=c("model1","model2","model3","model4","model5","model6"),pch=1,
pt.lwd = 2, col=c("red","orange","blue","lightblue","darkgreen","green"))
ts.plot(ts_hosr,main="All Forecasts",ylab="homeownership rate",ylim=c(50,70))
points(final.pred.1,lwd=2,col="red")
points(final.pred.2,lwd=2,col="orange")
points(ts(final.pred.3a[,1],start=154),lwd=2,col="blue")
points(ts(final.pred.3b[,1],start=154),lwd=2,col="lightblue")
points(ts(final.pred.4a[,1],start=154),lwd=2,col="darkgreen")
points(ts(final.pred.4b[,1],start=154),lwd=2,col="green")
legend(x=1,y=425,legend=c("model1","model2","model3","model4","model5","model6"),pch=1,
pt.lwd = 2, col=c("red","orange","blue","lightblue","darkgreen","green"))
ts.plot(ts_hosr,main="All Forecasts",ylab="homeownership rate",ylim=c(60,70))
points(final.pred.1,lwd=2,col="red")
points(final.pred.2,lwd=2,col="orange")
points(ts(final.pred.3a[,1],start=154),lwd=2,col="blue")
points(ts(final.pred.3b[,1],start=154),lwd=2,col="lightblue")
points(ts(final.pred.4a[,1],start=154),lwd=2,col="darkgreen")
points(ts(final.pred.4b[,1],start=154),lwd=2,col="green")
legend(x=1,y=425,legend=c("model1","model2","model3","model4","model5","model6"),pch=1,
pt.lwd = 2, col=c("red","orange","blue","lightblue","darkgreen","green"))
ts.plot(ts_hosr,main="All Forecasts",ylab="homeownership rate",ylim=c(60,70))
#points(final.pred.1,lwd=2,col="red")
points(final.pred.2,lwd=2,col="orange")
points(ts(final.pred.3a[,1],start=154),lwd=2,col="blue")
points(ts(final.pred.3b[,1],start=154),lwd=2,col="lightblue")
points(ts(final.pred.4a[,1],start=154),lwd=2,col="darkgreen")
points(ts(final.pred.4b[,1],start=154),lwd=2,col="green")
legend(x=1,y=425,legend=c("model1","model2","model3","model4","model5","model6"),pch=1,
pt.lwd = 2, col=c("red","orange","blue","lightblue","darkgreen","green"))
final.pred.2
final.pred.1
ts.plot(ts_hosr,main="All Forecasts",ylab="homeownership rate",ylim=c(60,70))
points(final.pred.1,lwd=2,col="red")
points(final.pred.2,lwd=2,col="orange")
points(ts(final.pred.3a[,1],start=154),lwd=2,col="blue")
points(ts(final.pred.3b[,1],start=154),lwd=2,col="lightblue")
points(ts(final.pred.4a[,1],start=154),lwd=2,col="darkgreen")
points(ts(final.pred.4b[,1],start=154),lwd=2,col="green")
legend(x=1,y=425,legend=c("model1","model2","model3","model4","model5","model6"),pch=1,
pt.lwd = 2, col=c("red","orange","blue","lightblue","darkgreen","green"))
final.pred.1
ts.plot(ts_hosr,main="All Forecasts",ylab="homeownership rate",ylim=c(60,70))
points(final.pred.1,lwd=2,col="red")
points(ts(final.pred.2,start=2018.25),lwd=2,col="orange")
points(ts(final.pred.3a[,1],start=2018.25),lwd=2,col="blue")
points(ts(final.pred.3b[,1],start=2018.25),lwd=2,col="lightblue")
points(ts(final.pred.4a[,1],start=2018.25),lwd=2,col="darkgreen")
points(ts(final.pred.4b[,1],start=2018.25),lwd=2,col="green")
legend(x=1,y=425,legend=c("model1","model2","model3","model4","model5","model6"),pch=1,
pt.lwd = 2, col=c("red","orange","blue","lightblue","darkgreen","green"))
ts.plot(ts_hosr,main="All Forecasts",ylab="homeownership rate",ylim=c(62,69))
points(final.pred.1,lwd=2,col="red")
points(ts(final.pred.2,start=2018.25),lwd=2,col="orange")
points(ts(final.pred.3a[,1],start=2018.25),lwd=2,col="blue")
points(ts(final.pred.3b[,1],start=2018.25),lwd=2,col="lightblue")
points(ts(final.pred.4a[,1],start=2018.25),lwd=2,col="darkgreen")
points(ts(final.pred.4b[,1],start=2018.25),lwd=2,col="green")
legend(x=1,y=425,legend=c("model1","model2","model3","model4","model5","model6"),pch=1,
pt.lwd = 2, col=c("red","orange","blue","lightblue","darkgreen","green"))
ts.plot(ts_hosr,main="All Forecasts",ylab="homeownership rate",ylim=c(62,69))
points(final.pred.1,lwd=2,col="red")
points(ts(final.pred.2,start=2018.25),lwd=2,col="orange")
points(ts(final.pred.3a[,1],start=2018.25),lwd=2,col="blue")
points(ts(final.pred.3b[,1],start=2018.25),lwd=2,col="lightblue")
points(ts(final.pred.4a[,1],start=2018.25),lwd=2,col="darkgreen")
points(ts(final.pred.4b[,1],start=2018.25),lwd=2,col="green")
legend(x=1,y=1980,legend=c("model1","model2","model3","model4","model5","model6"),pch=1,
pt.lwd = 2, col=c("red","orange","blue","lightblue","darkgreen","green"))
ts.plot(ts_hosr,main="All Forecasts",ylab="homeownership rate",ylim=c(62,69))
points(final.pred.1,lwd=2,col="red")
points(ts(final.pred.2,start=2018.25),lwd=2,col="orange")
points(ts(final.pred.3a[,1],start=2018.25),lwd=2,col="blue")
points(ts(final.pred.3b[,1],start=2018.25),lwd=2,col="lightblue")
points(ts(final.pred.4a[,1],start=2018.25),lwd=2,col="darkgreen")
points(ts(final.pred.4b[,1],start=2018.25),lwd=2,col="green")
legend(x=1980,y=66,legend=c("model1","model2","model3","model4","model5","model6"),pch=1,
pt.lwd = 2, col=c("red","orange","blue","lightblue","darkgreen","green"))
ts.plot(ts_hosr,main="All Forecasts",ylab="homeownership rate",ylim=c(62,69))
points(final.pred.1,lwd=2,col="red")
points(ts(final.pred.2,start=2018.25),lwd=2,col="orange")
points(ts(final.pred.3a[,1],start=2018.25),lwd=2,col="blue")
points(ts(final.pred.3b[,1],start=2018.25),lwd=2,col="lightblue")
points(ts(final.pred.4a[,1],start=2018.25),lwd=2,col="darkgreen")
points(ts(final.pred.4b[,1],start=2018.25),lwd=2,col="green")
legend(x=1980,y=69,legend=c("model1","model2","model3","model4","model5","model6"),pch=1,
pt.lwd = 2, col=c("red","orange","blue","lightblue","darkgreen","green"))
testing
testing$hosr
cat("Model1 MAPE:",mean(abs(final.pred.1-testing$hosr)/testing$hosr),
"\nModel1 PM:", sum((final.pred.1-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nModel2 MAPE:",mean(abs(final.pred.2-testing$hosr)/testing$hosr),
"\nModel2 PM:", sum((final.pred.2-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2))
testing$hosr
cat("Model1 MAPE:",mean(abs(final.pred.1-testing$hosr)/testing$hosr),
"\nModel1 PM:", sum((final.pred.1-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nModel2 MAPE:",mean(abs(final.pred.2-testing$hosr)/testing$hosr),
"\nModel2 PM:", sum((final.pred.2-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nModel3a MAPE:",mean(abs(final.pred.3a-testing$hosr)/testing$hosr),
"\nModel3a PM:", sum((final.pred.3a-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nModel3b MAPE:",mean(abs(final.pred.3b-testing$hosr)/testing$hosr),
"\nModel3b PM:", sum((final.pred.3b-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nModel4a MAPE:",mean(abs(final.pred.4a-testing$hosr)/testing$hosr),
"\nModel4a PM:", sum((final.pred.4a-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nModel4b MAPE:",mean(abs(final.pred.4b-testing$hosr)/testing$hosr),
"\nModel4b PM:", sum((final.pred.4b-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2))
ts.plot(ts_hosr,main="All Forecasts",ylab="homeownership rate",ylim=c(62,69))
points(final.pred.1,lwd=2,col="red")
points(ts(final.pred.2,start=2018.25),lwd=2,col="orange")
points(ts(final.pred.3a[,1],start=2018.25),lwd=2,col="blue")
points(ts(final.pred.3b[,1],start=2018.25),lwd=2,col="lightblue")
points(ts(final.pred.4a[,1],start=2018.25),lwd=2,col="darkgreen")
points(ts(final.pred.4b[,1],start=2018.25),lwd=2,col="green")
legend(x=1980,y=69,legend=c("model1","model2","model3a","model3b","model4a","model4b"),pch=1,
pt.lwd = 2, col=c("red","orange","blue","lightblue","darkgreen","green"))
testing[,"hosr"]
ts(final.pred.3a[,1],start=2018.25
dd
ts(final.pred.3a[,1],start=2018.25)
ts.plot(ts_hosr,main="All Forecasts",ylab="homeownership rate",ylim=c(62,69))
points(final.pred.1,lwd=2,col="red")
points(ts(final.pred.2,start=2018.25,freq=4),lwd=2,col="orange")
points(ts(final.pred.3a[,1],start=2018.25,freq=4),lwd=2,col="blue")
points(ts(final.pred.3b[,1],start=2018.25,freq=4),lwd=2,col="lightblue")
points(ts(final.pred.4a[,1],start=2018.25,freq=4),lwd=2,col="darkgreen")
points(ts(final.pred.4b[,1],start=2018.25,freq=4),lwd=2,col="green")
legend(x=1980,y=69,legend=c("model1","model2","model3a","model3b","model4a","model4b"),pch=1,
pt.lwd = 2, col=c("red","orange","blue","lightblue","darkgreen","green"))
final.pred.3a
var_data <- cbind(ts_hosr,ts_cpi,ts_dispic,ts_fedfunds,ts_gdp,ts_icsa,ts_mspus,ts_payem,ts_sp500,ts_permit,ts_umcsent,ts_unrate)
VARselect(var_data, lag.max = 20)$selection
var_data <- cbind(ts_hosr,ts_cpi,ts_dispic,ts_fedfunds,ts_gdp,ts_icsa,ts_mspus,ts_payem,ts_sp500,ts_permit,ts_umcsent,ts_unrate)
VARselect(var_data, lag.max = 21)$selection
model.var=VAR(var_data, p=13)
summary(model.var$varresult$ts_hosr)
## Model Fitting: Restricted VAR
model.var.restrict=restrict(model.var)
model.var=VAR(var_data, p=13)
summary(model.var$varresult$ts_hosr)
## Model Fitting: Restricted VAR
model.var.restrict=restrict(model.var)
model.var=VAR(var_data, p=11)
summary(model.var$varresult$ts_hosr)
## Model Fitting: Restricted VAR
model.var.restrict=restrict(model.var)
summary(model.var.restrict$varresult$ts_hosr)
model.var=VAR(var_data, p=12)
summary(model.var$varresult$ts_hosr)
## Model Fitting: Restricted VAR
model.var.restrict=restrict(model.var)
summary(model.var.restrict$varresult$ts_hosr)
coef.hosr = coefficients(model.var)$ts_hosr[-(12*12+1),1]
var.model = vcov(model.var)[2:145,2:145]
## Granger Causality: CPI
print("CPI")
wald.test(b=coef.hosr, var.model, Terms=seq(2, 12*12, 12))
## Granger Causality: disposible income
print("disposible income")
wald.test(b=coef.hosr, var.model, Terms=seq(3, 12*12, 12))
## Granger Causality: interet rate
print("interet rate")
wald.test(b=coef.hosr, var.model, Terms=seq(4, 12*12, 12))
## Granger Causality: gdp
print("gdp")
wald.test(b=coef.hosr, var.model, Terms=seq(5, 12*12, 12))
## Granger Causality: innial claims
print("innial claims")
wald.test(b=coef.hosr, var.model, Terms=seq(6, 12*12, 12))
## Granger Causality: median housing price
print("median housing price")
wald.test(b=coef.hosr, var.model, Terms=seq(7, 12*12, 12))
## Granger Causality: non farm payroll
print("non farm payroll")
wald.test(b=coef.hosr, var.model, Terms=seq(8, 12*12, 12))
## Granger Causality: housing permit
print("housing permit")
wald.test(b=coef.hosr, var.model, Terms=seq(9, 12*12, 12))
## Granger Causality: sp500
print("sp500")
wald.test(b=coef.hosr, var.model, Terms=seq(10, 12*12, 12))
## Granger Causality: consumer sentiments
print("consumer sentiments")
wald.test(b=coef.hosr, var.model, Terms=seq(11, 12*12, 12))
## Granger Causality: unemployment rate
print("unemployment rate")
wald.test(b=coef.hosr, var.model, Terms=seq(12, 12*12, 12))
model.var=VAR(var_data, p=11)
summary(model.var$varresult$ts_hosr)
## Model Fitting: Restricted VAR
model.var.restrict=restrict(model.var)
summary(model.var.restrict$varresult$ts_hosr)
coef.hosr = coefficients(model.var)$ts_hosr[-(12*12+1),1]
var.model = vcov(model.var)[2:145,2:145]
## Granger Causality: CPI
print("CPI")
wald.test(b=coef.hosr, var.model, Terms=seq(2, 12*12, 12))
coef.hosr = coefficients(model.var)$ts_hosr[-(12*11+1),1]
var.model = vcov(model.var)[2:145,2:145]
## Granger Causality: CPI
print("CPI")
wald.test(b=coef.hosr, var.model, Terms=seq(2, 12*11, 12))
a <- vcov(model.var)
View(a)
View(a)
coef.hosr = coefficients(model.var)$ts_hosr[-(12*11+1),1]
var.model = vcov(model.var)[2:133,2:133]
## Granger Causality: CPI
print("CPI")
wald.test(b=coef.hosr, var.model, Terms=seq(2, 12*11, 12))
## Granger Causality: disposible income
print("disposible income")
wald.test(b=coef.hosr, var.model, Terms=seq(3, 12*11, 12))
## Granger Causality: interet rate
print("interet rate")
wald.test(b=coef.hosr, var.model, Terms=seq(4, 12*11, 12))
## Granger Causality: gdp
print("gdp")
wald.test(b=coef.hosr, var.model, Terms=seq(5, 12*11, 12))
## Granger Causality: innial claims
print("innial claims")
wald.test(b=coef.hosr, var.model, Terms=seq(6, 12*11, 12))
## Granger Causality: median housing price
print("median housing price")
wald.test(b=coef.hosr, var.model, Terms=seq(7, 12*11, 12))
## Granger Causality: non farm payroll
print("non farm payroll")
wald.test(b=coef.hosr, var.model, Terms=seq(8, 12*11, 12))
## Granger Causality: housing permit
print("housing permit")
wald.test(b=coef.hosr, var.model, Terms=seq(9, 12*11, 12))
## Granger Causality: sp500
print("sp500")
wald.test(b=coef.hosr, var.model, Terms=seq(10, 12*11, 12))
## Granger Causality: consumer sentiments
print("consumer sentiments")
wald.test(b=coef.hosr, var.model, Terms=seq(11, 12*12, 12))
var_data <- cbind(ts_hosr,ts_cpi,ts_dispic,ts_fedfunds,ts_gdp,ts_icsa,ts_mspus,ts_payem,ts_permit,ts_sp500,ts_umcsent,ts_unrate)
VARselect(var_data, lag.max = 21)$selection
model.var=VAR(var_data, p=11)
summary(model.var$varresult$ts_hosr)
## Model Fitting: Restricted VAR
model.var.restrict=restrict(model.var)
summary(model.var.restrict$varresult$ts_hosr)
coef.hosr = coefficients(model.var)$ts_hosr[-(12*11+1),1]
var.model = vcov(model.var)[2:133,2:133]
## Granger Causality: CPI
print("CPI")
wald.test(b=coef.hosr, var.model, Terms=seq(2, 12*11, 12))
## Granger Causality: disposible income
print("disposible income")
wald.test(b=coef.hosr, var.model, Terms=seq(3, 12*11, 12))
## Granger Causality: interet rate
print("interet rate")
wald.test(b=coef.hosr, var.model, Terms=seq(4, 12*11, 12))
## Granger Causality: gdp
print("gdp")
wald.test(b=coef.hosr, var.model, Terms=seq(5, 12*11, 12))
## Granger Causality: innial claims
print("innial claims")
wald.test(b=coef.hosr, var.model, Terms=seq(6, 12*11, 12))
## Granger Causality: median housing price
print("median housing price")
wald.test(b=coef.hosr, var.model, Terms=seq(7, 12*11, 12))
## Granger Causality: non farm payroll
print("non farm payroll")
wald.test(b=coef.hosr, var.model, Terms=seq(8, 12*11, 12))
## Granger Causality: housing permit
print("housing permit")
wald.test(b=coef.hosr, var.model, Terms=seq(9, 12*11, 12))
## Granger Causality: sp500
print("sp500")
wald.test(b=coef.hosr, var.model, Terms=seq(10, 12*11, 12))
## Granger Causality: consumer sentiments
print("consumer sentiments")
wald.test(b=coef.hosr, var.model, Terms=seq(11, 12*12, 12))
coef.hosr = coefficients(model.var)$ts_hosr[-(12*11+1),1]
var.model = vcov(model.var)[2:133,2:133]
## Granger Causality: CPI
print("CPI")
wald.test(b=coef.hosr, var.model, Terms=seq(2, 12*11, 12))
## Granger Causality: disposible income
print("disposible income")
wald.test(b=coef.hosr, var.model, Terms=seq(3, 12*11, 12))
## Granger Causality: interet rate
print("interet rate")
wald.test(b=coef.hosr, var.model, Terms=seq(4, 12*11, 12))
## Granger Causality: gdp
print("gdp")
wald.test(b=coef.hosr, var.model, Terms=seq(5, 12*11, 12))
## Granger Causality: innial claims
print("innial claims")
wald.test(b=coef.hosr, var.model, Terms=seq(6, 12*11, 12))
## Granger Causality: median housing price
print("median housing price")
wald.test(b=coef.hosr, var.model, Terms=seq(7, 12*11, 12))
## Granger Causality: non farm payroll
print("non farm payroll")
wald.test(b=coef.hosr, var.model, Terms=seq(8, 12*11, 12))
## Granger Causality: housing permit
print("housing permit")
wald.test(b=coef.hosr, var.model, Terms=seq(9, 12*11, 12))
## Granger Causality: sp500
print("sp500")
wald.test(b=coef.hosr, var.model, Terms=seq(10, 12*11, 12))
## Granger Causality: consumer sentiments
print("consumer sentiments")
wald.test(b=coef.hosr, var.model, Terms=seq(11, 12*11, 12))
## Granger Causality: unemployment rate
print("unemployment rate")
wald.test(b=coef.hosr, var.model, Terms=seq(12, 12*11, 12))
model.var=VAR(var_data, p=10)
summary(model.var$varresult$ts_hosr)
## Model Fitting: Restricted VAR
model.var.restrict=restrict(model.var)
summary(model.var.restrict$varresult$ts_hosr)
coef.hosr = coefficients(model.var)$ts_hosr[-(12*11+1),1]
var.model = vcov(model.var)[2:133,2:133]
## Granger Causality: CPI
print("CPI")
wald.test(b=coef.hosr, var.model, Terms=seq(2, 12*11, 12))
coef.hosr = coefficients(model.var)$ts_hosr[-(12*11+1),1]
var.model = vcov(model.var)[2:121,2:121]
## Granger Causality: CPI
print("CPI")
wald.test(b=coef.hosr, var.model, Terms=seq(2, 12*10, 12))
a<-vcov(model.var)
View(a)
coef.hosr = coefficients(model.var)$ts_hosr[-(12*11+1),1]
var.model = vcov(model.var)[2:120,2:120]
## Granger Causality: CPI
print("CPI")
wald.test(b=coef.hosr, var.model, Terms=seq(2, 12*10, 12))
coef.hosr = coefficients(model.var)$ts_hosr[-(12*10+1),1]
var.model = vcov(model.var)[2:120,2:120]
## Granger Causality: CPI
print("CPI")
wald.test(b=coef.hosr, var.model, Terms=seq(2, 12*10, 12))
coef.hosr = coefficients(model.var)$ts_hosr[-(12*10+1),1]
var.model = vcov(model.var)[2:121,2:121]
## Granger Causality: CPI
print("CPI")
wald.test(b=coef.hosr, var.model, Terms=seq(2, 12*10, 12))
## Granger Causality: disposible income
print("disposible income")
wald.test(b=coef.hosr, var.model, Terms=seq(3, 12*10, 12))
## Granger Causality: interet rate
print("interet rate")
wald.test(b=coef.hosr, var.model, Terms=seq(4, 12*10, 12))
## Granger Causality: gdp
print("gdp")
wald.test(b=coef.hosr, var.model, Terms=seq(5, 12*10, 12))
## Granger Causality: innial claims
print("innial claims")
wald.test(b=coef.hosr, var.model, Terms=seq(6, 12*10, 12))
## Granger Causality: median housing price
print("median housing price")
wald.test(b=coef.hosr, var.model, Terms=seq(7, 12*10, 12))
## Granger Causality: non farm payroll
print("non farm payroll")
wald.test(b=coef.hosr, var.model, Terms=seq(8, 12*10, 12))
## Granger Causality: housing permit
print("housing permit")
wald.test(b=coef.hosr, var.model, Terms=seq(9, 12*10, 12))
## Granger Causality: sp500
print("sp500")
wald.test(b=coef.hosr, var.model, Terms=seq(10, 12*11, 12))
coef.hosr = coefficients(model.var)$ts_hosr[-(12*10+1),1]
var.model = vcov(model.var)[2:121,2:121]
## Granger Causality: CPI
print("CPI")
wald.test(b=coef.hosr, var.model, Terms=seq(2, 12*10, 12))
## Granger Causality: disposible income
print("disposible income")
wald.test(b=coef.hosr, var.model, Terms=seq(3, 12*10, 12))
## Granger Causality: interet rate
print("interet rate")
wald.test(b=coef.hosr, var.model, Terms=seq(4, 12*10, 12))
## Granger Causality: gdp
print("gdp")
wald.test(b=coef.hosr, var.model, Terms=seq(5, 12*10, 12))
## Granger Causality: innial claims
print("innial claims")
wald.test(b=coef.hosr, var.model, Terms=seq(6, 12*10, 12))
## Granger Causality: median housing price
print("median housing price")
wald.test(b=coef.hosr, var.model, Terms=seq(7, 12*10, 12))
## Granger Causality: non farm payroll
print("non farm payroll")
wald.test(b=coef.hosr, var.model, Terms=seq(8, 12*10, 12))
## Granger Causality: housing permit
print("housing permit")
wald.test(b=coef.hosr, var.model, Terms=seq(9, 12*10, 12))
## Granger Causality: sp500
print("sp500")
wald.test(b=coef.hosr, var.model, Terms=seq(10, 12*10, 12))
## Granger Causality: consumer sentiments
print("consumer sentiments")
wald.test(b=coef.hosr, var.model, Terms=seq(11, 12*10, 12))
## Granger Causality: unemployment rate
print("unemployment rate")
wald.test(b=coef.hosr, var.model, Terms=seq(12, 12*10, 12))
