lines(ts(m_var_log.pred,start=2018.25,freq=4),lwd=2,col="darkgreen")
lines(ts(m_rs_var_log.pred,start=2018.25,freq=4),lwd=2,col="green")
lines(ts(m_varx_org.pred,start=2018.25,freq=4),lwd=2,col="lightgreen")
lines(ts(m_rs_varx_org.pred,start=2018.25,freq=4),lwd=2,col="pink")
lines(ts(m_arima_ori_pred.pred,start=2018.25,freq=4),lwd=2,col="yellow")
lines(ts(m_arima_log_pred.pred,start=2018.25,freq=4),lwd=2,col="grey")
lines(ts(m_arimax_ori_pred.pred,start=2018.25,freq=4),lwd=2,col="darkblue")
lines(ts(m_arimax_log_pred.pred,start=2018.25,freq=4),lwd=2,col="darkred")
legend(x=1980,y=69,legend=c("gam_arma_o","gam_arma_l","var_o","rs_var_o","var_l","rs_var_l","varx_o","rs_varx_o","arima_o","arima_l","arimax_o","arimax_l"),pch=1,
pt.lwd = 2, col=c("red","orange","blue","lightblue","green","darkgreen","pink","yellow","grey","darkblue","darkred"))
## Individual Plots
par(mfrow=c(3, 2))
##Trend Estimation + ARMA
ts.plot(ts_hosr,main="Org Forecast:spline Trend + ARMA",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_gam_arma_org.pred,start=2018.25,freq=4),lwd=2,col="red")
lines(ts(m_gam_arma_org.ubound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_gam_arma_org.lbound,start=2018.25,freq=4),lwd=3,col="blue")
ts.plot(ts_hosr,main="Log Forecast:spline Trend + ARMA",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_gam_arma_log.pred,start=2018.25,freq=4),lwd=2,col="green")
lines(ts(m_gam_arma_log.ubound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_gam_arma_log.lbound,start=2018.25,freq=4),lwd=3,col="blue")
## VAR Ori
ts.plot(ts_hosr,main="Ori Forecast:Unrestrict VAR",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_var_org.pred,start=2018.25,freq=4),lwd=2,col="red")
lines(ts(m_var_org.pred.lbound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_var_org.pred.ubound,start=2018.25,freq=4),lwd=3,col="blue")
ts.plot(ts_hosr,main="Ori Forecast:Restrict VAR",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_rs_var_org.pred,start=2018.25,freq=4),lwd=2,col="green")
lines(ts(m_rs_var_org.pred.lbound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_rs_var_org.pred.ubound,start=2018.25,freq=4),lwd=3,col="blue")
##VAR Log
ts.plot(ts_hosr,main="Log Forecast:Unrestrict VAR",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_var_log.pred,start=2018.25,freq=4),lwd=2,col="red")
lines(ts(m_var_log.pred.lbound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_var_log.pred.ubound,start=2018.25,freq=4),lwd=3,col="blue")
ts.plot(ts_hosr,main="Log Forecast:Restrict VAR",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_rs_var_log.pred,start=2018.25,freq=4),lwd=2,col="green")
lines(ts(m_rs_var_log.pred.lbound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_rs_var_log.pred.ubound,start=2018.25,freq=4),lwd=3,col="blue")
par(mfrow=c(3, 2))
## VARX
ts.plot(ts_hosr,main="Ori Forecast:Unrestrict VARX",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_varx_org.pred,start=2018.25,freq=4),lwd=2,col="red")
lines(ts(m_varx_org.pred.lbound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_varx_org.pred.ubound,start=2018.25,freq=4),lwd=3,col="blue")
ts.plot(ts_hosr,main="Ori Forecast:Restrict VARX",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_rs_var_log.pred,start=2018.25,freq=4),lwd=2,col="green")
lines(ts(m_rs_var_log.pred.lbound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_rs_var_log.pred.ubound,start=2018.25,freq=4),lwd=3,col="blue")
##ARIMA
ts.plot(ts_hosr,main="Ori Forecasts:ARIMA",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_arima_ori_pred.pred,start=2018.25,freq=4),lwd=2,col="red")
lines(ts(m_arima_ori_pred.ubound,start=2018.25,freq=4),lwd=2,col="blue")
lines(ts(m_arima_ori_pred.lbound,start=2018.25,freq=4),lwd=2,col="blue")
ts.plot(ts_hosr,main="Log Forecasts:ARIMA",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_arima_log_pred.pred,start=2018.25,freq=4),lwd=3,col="green")
lines(ts(m_arima_log_pred.ubound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_arima_log_pred.lbound,start=2018.25,freq=4),lwd=3,col="blue")
##ARIMAX
ts.plot(ts_hosr,main="Ori Forecasts:ARIMAX",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_arimax_ori_pred.pred,start=2018.25,freq=4),lwd=2,col="red")
lines(ts(m_arimax_ori_pred.ubound,start=2018.25,freq=4),lwd=2,col="blue")
lines(ts(m_arimax_ori_pred.lbound,start=2018.25,freq=4),lwd=2,col="blue")
ts.plot(ts_hosr,main="Log Forecasts:ARIMAX",ylab="homeownership rate",ylim=c(62,69))
lines(ts(exp(m_arimax_log_pred.pred),start=2018.25,freq=4),lwd=3,col="green")
lines(ts(exp(m_arimax_log_pred.ubound),start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(exp(m_arimax_log_pred.lbound),start=2018.25,freq=4),lwd=3,col="blue")
testing$hosr
cat("\ngam_arma_org MAPE:",mean(abs(m_gam_arma_org.pred-testing$hosr)/testing$hosr),
"\ngam_arma_org PM:",sum((m_gam_arma_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\ngam_arma_log MAPE:",mean(abs(m_gam_arma_log.pred-testing$hosr)/testing$hosr),
"\ngam_arma_log PM:",sum((m_gam_arma_log.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_var_org MAPE:",mean(abs(m_var_org.pred-testing$hosr)/testing$hosr),
"\nm_var_org PM:",sum((m_var_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_var_log MAPE:",mean(abs(m_var_log.pred-testing$hosr)/testing$hosr),
"\nm_var_log PM:",sum((m_var_log.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_rs_var_org MAPE:",mean(abs(m_rs_var_org.pred-testing$hosr)/testing$hosr),
"\nm_rs_var_org PM:",sum((m_rs_var_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_rs_var_log MAPE:",mean(abs(m_rs_var_log.pred-testing$hosr)/testing$hosr),
"\nm_rs_var_log PM:",sum((m_rs_var_log.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_varx_org MAPE:",mean(abs(m_varx_org.pred-testing$hosr)/testing$hosr),
"\nm_varx_org PM:",sum((m_varx_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_rs_varx_org MAPE:",mean(abs(m_rs_varx_org.pred-testing$hosr)/testing$hosr),
"\nm_rs_varx_org PM:",sum((m_rs_varx_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_arima_ori MAPE:",mean(abs((m_arima_ori_pred.pred$hosr)/testing$hosr)),
"\nm_arima_ori PM:",sum(((m_arima_ori_pred.pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)),
"\nm_arima_log MAPE:",mean(abs((m_arima_log_pred.pred$hosr)/testing$hosr)),
"\nm_arima_log PM:",sum(((m_arima_log_pred.pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)),
"\nm_arimax_ori MAPE:",mean(abs((m_arimax_ori_pred.pred$hosr)/testing$hosr)),
"\nm_arimax_ori PM:",sum(((m_arimax_ori_pred.pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)),
"\nm_arimax_log MAPE:",mean(abs((m_arimax_log_pred.pred$hosr)/testing$hosr)),
"\nm_arimax_log PM:",sum(((m_arimax_log_pred.pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)))
m_arima_ori_pred.pred
testing$hosr
cat("\ngam_arma_org MAPE:",mean(abs(m_gam_arma_org.pred-testing$hosr)/testing$hosr),
"\ngam_arma_org PM:",sum((m_gam_arma_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\ngam_arma_log MAPE:",mean(abs(m_gam_arma_log.pred-testing$hosr)/testing$hosr),
"\ngam_arma_log PM:",sum((m_gam_arma_log.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_var_org MAPE:",mean(abs(m_var_org.pred-testing$hosr)/testing$hosr),
"\nm_var_org PM:",sum((m_var_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_var_log MAPE:",mean(abs(m_var_log.pred-testing$hosr)/testing$hosr),
"\nm_var_log PM:",sum((m_var_log.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_rs_var_org MAPE:",mean(abs(m_rs_var_org.pred-testing$hosr)/testing$hosr),
"\nm_rs_var_org PM:",sum((m_rs_var_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_rs_var_log MAPE:",mean(abs(m_rs_var_log.pred-testing$hosr)/testing$hosr),
"\nm_rs_var_log PM:",sum((m_rs_var_log.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_varx_org MAPE:",mean(abs(m_varx_org.pred-testing$hosr)/testing$hosr),
"\nm_varx_org PM:",sum((m_varx_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_rs_varx_org MAPE:",mean(abs(m_rs_varx_org.pred-testing$hosr)/testing$hosr),
"\nm_rs_varx_org PM:",sum((m_rs_varx_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_arima_ori MAPE:",mean(abs((m_arima_ori_pred.pred)/testing$hosr)),
"\nm_arima_ori PM:",sum(((m_arima_ori_pred.pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)),
"\nm_arima_log MAPE:",mean(abs((m_arima_log_pred.pred)/testing$hosr)),
"\nm_arima_log PM:",sum(((m_arima_log_pred.pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)),
"\nm_arimax_ori MAPE:",mean(abs((m_arimax_ori_pred.pred$hosr)/testing$hosr)),
"\nm_arimax_ori PM:",sum(((m_arimax_ori_pred.pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)),
"\nm_arimax_log MAPE:",mean(abs((m_arimax_log_pred.pred$hosr)/testing$hosr)),
"\nm_arimax_log PM:",sum(((m_arimax_log_pred.pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)))
testing$hosr
cat("\ngam_arma_org MAPE:",mean(abs(m_gam_arma_org.pred-testing$hosr)/testing$hosr),
"\ngam_arma_org PM:",sum((m_gam_arma_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\ngam_arma_log MAPE:",mean(abs(m_gam_arma_log.pred-testing$hosr)/testing$hosr),
"\ngam_arma_log PM:",sum((m_gam_arma_log.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_var_org MAPE:",mean(abs(m_var_org.pred-testing$hosr)/testing$hosr),
"\nm_var_org PM:",sum((m_var_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_var_log MAPE:",mean(abs(m_var_log.pred-testing$hosr)/testing$hosr),
"\nm_var_log PM:",sum((m_var_log.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_rs_var_org MAPE:",mean(abs(m_rs_var_org.pred-testing$hosr)/testing$hosr),
"\nm_rs_var_org PM:",sum((m_rs_var_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_rs_var_log MAPE:",mean(abs(m_rs_var_log.pred-testing$hosr)/testing$hosr),
"\nm_rs_var_log PM:",sum((m_rs_var_log.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_varx_org MAPE:",mean(abs(m_varx_org.pred-testing$hosr)/testing$hosr),
"\nm_varx_org PM:",sum((m_varx_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_rs_varx_org MAPE:",mean(abs(m_rs_varx_org.pred-testing$hosr)/testing$hosr),
"\nm_rs_varx_org PM:",sum((m_rs_varx_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_arima_ori MAPE:",mean(abs((m_arima_ori_pred.pred)/testing$hosr)),
"\nm_arima_ori PM:",sum(((m_arima_ori_pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)),
"\nm_arima_log MAPE:",mean(abs((m_arima_log_pred)/testing$hosr)),
"\nm_arima_log PM:",sum(((m_arima_log_pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)),
"\nm_arimax_ori MAPE:",mean(abs((m_arimax_ori_pred.pred$hosr)/testing$hosr)),
"\nm_arimax_ori PM:",sum(((m_arimax_ori_pred.pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)),
"\nm_arimax_log MAPE:",mean(abs((m_arimax_log_pred.pred$hosr)/testing$hosr)),
"\nm_arimax_log PM:",sum(((m_arimax_log_pred.pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)))
testing$hosr
cat("\ngam_arma_org MAPE:",mean(abs(m_gam_arma_org.pred-testing$hosr)/testing$hosr),
"\ngam_arma_org PM:",sum((m_gam_arma_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\ngam_arma_log MAPE:",mean(abs(m_gam_arma_log.pred-testing$hosr)/testing$hosr),
"\ngam_arma_log PM:",sum((m_gam_arma_log.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_var_org MAPE:",mean(abs(m_var_org.pred-testing$hosr)/testing$hosr),
"\nm_var_org PM:",sum((m_var_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_var_log MAPE:",mean(abs(m_var_log.pred-testing$hosr)/testing$hosr),
"\nm_var_log PM:",sum((m_var_log.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_rs_var_org MAPE:",mean(abs(m_rs_var_org.pred-testing$hosr)/testing$hosr),
"\nm_rs_var_org PM:",sum((m_rs_var_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_rs_var_log MAPE:",mean(abs(m_rs_var_log.pred-testing$hosr)/testing$hosr),
"\nm_rs_var_log PM:",sum((m_rs_var_log.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_varx_org MAPE:",mean(abs(m_varx_org.pred-testing$hosr)/testing$hosr),
"\nm_varx_org PM:",sum((m_varx_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_rs_varx_org MAPE:",mean(abs(m_rs_varx_org.pred-testing$hosr)/testing$hosr),
"\nm_rs_varx_org PM:",sum((m_rs_varx_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_arima_ori MAPE:",mean(abs((m_arima_ori_pred.pred)/testing$hosr)),
"\nm_arima_ori PM:",sum(((m_arima_ori_pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)),
"\nm_arima_log MAPE:",mean(abs((m_arima_log_pred.pred)/testing$hosr)),
"\nm_arima_log PM:",sum(((m_arima_log_pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)),
"\nm_arimax_ori MAPE:",mean(abs((m_arimax_ori_pred.pred)/testing$hosr)),
"\nm_arimax_ori PM:",sum(((m_arimax_ori_pred.pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)),
"\nm_arimax_log MAPE:",mean(abs((m_arimax_log_pred.pred)/testing$hosr)),
"\nm_arimax_log PM:",sum(((m_arimax_log_pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)))
testing$hosr
cat("\ngam_arma_org MAPE:",mean(abs(m_gam_arma_org.pred-testing$hosr)/testing$hosr),
"\ngam_arma_org PM:",sum((m_gam_arma_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\ngam_arma_log MAPE:",mean(abs(m_gam_arma_log.pred-testing$hosr)/testing$hosr),
"\ngam_arma_log PM:",sum((m_gam_arma_log.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_var_org MAPE:",mean(abs(m_var_org.pred-testing$hosr)/testing$hosr),
"\nm_var_org PM:",sum((m_var_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_var_log MAPE:",mean(abs(m_var_log.pred-testing$hosr)/testing$hosr),
"\nm_var_log PM:",sum((m_var_log.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_rs_var_org MAPE:",mean(abs(m_rs_var_org.pred-testing$hosr)/testing$hosr),
"\nm_rs_var_org PM:",sum((m_rs_var_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_rs_var_log MAPE:",mean(abs(m_rs_var_log.pred-testing$hosr)/testing$hosr),
"\nm_rs_var_log PM:",sum((m_rs_var_log.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_varx_org MAPE:",mean(abs(m_varx_org.pred-testing$hosr)/testing$hosr),
"\nm_varx_org PM:",sum((m_varx_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_rs_varx_org MAPE:",mean(abs(m_rs_varx_org.pred-testing$hosr)/testing$hosr),
"\nm_rs_varx_org PM:",sum((m_rs_varx_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_arima_ori MAPE:",mean(abs((m_arima_ori_pred.pred)/testing$hosr)),
"\nm_arima_ori PM:",sum(((m_arima_ori_pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)),
"\nm_arima_log MAPE:",mean(abs((m_arima_log_pred.pred)/testing$hosr)),
"\nm_arima_log PM:",sum(((m_arima_log_pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)),
"\nm_arimax_ori MAPE:",mean(abs((m_arimax_ori_pred.pred)/testing$hosr)),
"\nm_arimax_ori PM:",sum(((m_arimax_ori_pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)),
"\nm_arimax_log MAPE:",mean(abs((m_arimax_log_pred.pred)/testing$hosr)),
"\nm_arimax_log PM:",sum(((m_arimax_log_pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)))
cat("\ngam_arma_org MAPE:",mean(abs(m_gam_arma_org.pred-testing$hosr)/testing$hosr),
"\ngam_arma_org PM:",sum((m_gam_arma_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\ngam_arma_log MAPE:",mean(abs(m_gam_arma_log.pred-testing$hosr)/testing$hosr),
"\ngam_arma_log PM:",sum((m_gam_arma_log.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_var_org MAPE:",mean(abs(m_var_org.pred-testing$hosr)/testing$hosr),
"\nm_var_org PM:",sum((m_var_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_var_log MAPE:",mean(abs(m_var_log.pred-testing$hosr)/testing$hosr),
"\nm_var_log PM:",sum((m_var_log.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_rs_var_org MAPE:",mean(abs(m_rs_var_org.pred-testing$hosr)/testing$hosr),
"\nm_rs_var_org PM:",sum((m_rs_var_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_rs_var_log MAPE:",mean(abs(m_rs_var_log.pred-testing$hosr)/testing$hosr),
"\nm_rs_var_log PM:",sum((m_rs_var_log.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_varx_org MAPE:",mean(abs(m_varx_org.pred-testing$hosr)/testing$hosr),
"\nm_varx_org PM:",sum((m_varx_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_rs_varx_org MAPE:",mean(abs(m_rs_varx_org.pred-testing$hosr)/testing$hosr),
"\nm_rs_varx_org PM:",sum((m_rs_varx_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_arima_ori MAPE:",mean(abs((m_arima_ori_pred.pred)/testing$hosr)),
"\nm_arima_ori PM:",sum(((m_arima_ori_pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)),
"\nm_arima_log MAPE:",mean(abs((m_arima_log_pred.pred)/testing$hosr)),
"\nm_arima_log PM:",sum(((m_arima_log_pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)),
"\nm_arimax_ori MAPE:",mean(abs((m_arimax_ori_pred.pred)/testing$hosr)),
"\nm_arimax_ori PM:",sum(((m_arimax_ori_pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)),
"\nm_arimax_log MAPE:",mean(abs((m_arimax_log_pred.pred)/testing$hosr)),
"\nm_arimax_log PM:",sum(((m_arimax_log_pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)))
m_arimax_log_pred.pred
m_arimax_ori_pred.pred = data.frame(m_arimax_ori_pred)[,"Point.Forecast"]
m_arimax_ori_pred.ubound = data.frame(m_arimax_ori_pred)[, "Hi.95"]
m_arimax_ori_pred.lbound = data.frame(m_arimax_ori_pred)[, "Lo.95"]
m_arimax_log_pred.pred = exp(data.frame(m_arimax_log_pred)[,"Point.Forecast"])
m_arimax_log_pred.ubound = data.frame(m_arimax_log_pred)[, "Hi.95"]
m_arimax_log_pred.lbound = data.frame(m_arimax_log_pred)[, "Lo.95"]
## Combined Forecast Plot
ts.plot(ts_hosr,main="All Forecasts",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_gam_arma_org.pred,start=2018.25,freq=4),lwd=2,col="red")
lines(ts(m_gam_arma_log.pred,start=2018.25,freq=4),lwd=2,col="orange")
lines(ts(m_var_org.pred,start=2018.25,freq=4),lwd=2,col="blue")
lines(ts(m_rs_var_org.pred,start=2018.25,freq=4),lwd=2,col="lightblue")
lines(ts(m_var_log.pred,start=2018.25,freq=4),lwd=2,col="darkgreen")
lines(ts(m_rs_var_log.pred,start=2018.25,freq=4),lwd=2,col="green")
lines(ts(m_varx_org.pred,start=2018.25,freq=4),lwd=2,col="lightgreen")
lines(ts(m_rs_varx_org.pred,start=2018.25,freq=4),lwd=2,col="pink")
lines(ts(m_arima_ori_pred.pred,start=2018.25,freq=4),lwd=2,col="yellow")
lines(ts(m_arima_log_pred.pred,start=2018.25,freq=4),lwd=2,col="grey")
lines(ts(m_arimax_ori_pred.pred,start=2018.25,freq=4),lwd=2,col="darkblue")
lines(ts(m_arimax_log_pred.pred,start=2018.25,freq=4),lwd=2,col="darkred")
legend(x=1980,y=69,legend=c("gam_arma_o","gam_arma_l","var_o","rs_var_o","var_l","rs_var_l","varx_o","rs_varx_o","arima_o","arima_l","arimax_o","arimax_l"),pch=1,
pt.lwd = 2, col=c("red","orange","blue","lightblue","green","darkgreen","pink","yellow","grey","darkblue","darkred"))
## Individual Plots
par(mfrow=c(3, 2))
##Trend Estimation + ARMA
ts.plot(ts_hosr,main="Org Forecast:spline Trend + ARMA",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_gam_arma_org.pred,start=2018.25,freq=4),lwd=2,col="red")
lines(ts(m_gam_arma_org.ubound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_gam_arma_org.lbound,start=2018.25,freq=4),lwd=3,col="blue")
ts.plot(ts_hosr,main="Log Forecast:spline Trend + ARMA",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_gam_arma_log.pred,start=2018.25,freq=4),lwd=2,col="green")
lines(ts(m_gam_arma_log.ubound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_gam_arma_log.lbound,start=2018.25,freq=4),lwd=3,col="blue")
## VAR Ori
ts.plot(ts_hosr,main="Ori Forecast:Unrestrict VAR",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_var_org.pred,start=2018.25,freq=4),lwd=2,col="red")
lines(ts(m_var_org.pred.lbound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_var_org.pred.ubound,start=2018.25,freq=4),lwd=3,col="blue")
ts.plot(ts_hosr,main="Ori Forecast:Restrict VAR",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_rs_var_org.pred,start=2018.25,freq=4),lwd=2,col="green")
lines(ts(m_rs_var_org.pred.lbound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_rs_var_org.pred.ubound,start=2018.25,freq=4),lwd=3,col="blue")
##VAR Log
ts.plot(ts_hosr,main="Log Forecast:Unrestrict VAR",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_var_log.pred,start=2018.25,freq=4),lwd=2,col="red")
lines(ts(m_var_log.pred.lbound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_var_log.pred.ubound,start=2018.25,freq=4),lwd=3,col="blue")
ts.plot(ts_hosr,main="Log Forecast:Restrict VAR",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_rs_var_log.pred,start=2018.25,freq=4),lwd=2,col="green")
lines(ts(m_rs_var_log.pred.lbound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_rs_var_log.pred.ubound,start=2018.25,freq=4),lwd=3,col="blue")
par(mfrow=c(3, 2))
## VARX
ts.plot(ts_hosr,main="Ori Forecast:Unrestrict VARX",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_varx_org.pred,start=2018.25,freq=4),lwd=2,col="red")
lines(ts(m_varx_org.pred.lbound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_varx_org.pred.ubound,start=2018.25,freq=4),lwd=3,col="blue")
ts.plot(ts_hosr,main="Ori Forecast:Restrict VARX",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_rs_var_log.pred,start=2018.25,freq=4),lwd=2,col="green")
lines(ts(m_rs_var_log.pred.lbound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_rs_var_log.pred.ubound,start=2018.25,freq=4),lwd=3,col="blue")
##ARIMA
ts.plot(ts_hosr,main="Ori Forecasts:ARIMA",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_arima_ori_pred.pred,start=2018.25,freq=4),lwd=2,col="red")
lines(ts(m_arima_ori_pred.ubound,start=2018.25,freq=4),lwd=2,col="blue")
lines(ts(m_arima_ori_pred.lbound,start=2018.25,freq=4),lwd=2,col="blue")
ts.plot(ts_hosr,main="Log Forecasts:ARIMA",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_arima_log_pred.pred,start=2018.25,freq=4),lwd=3,col="green")
lines(ts(m_arima_log_pred.ubound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_arima_log_pred.lbound,start=2018.25,freq=4),lwd=3,col="blue")
##ARIMAX
ts.plot(ts_hosr,main="Ori Forecasts:ARIMAX",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_arimax_ori_pred.pred,start=2018.25,freq=4),lwd=2,col="red")
lines(ts(m_arimax_ori_pred.ubound,start=2018.25,freq=4),lwd=2,col="blue")
lines(ts(m_arimax_ori_pred.lbound,start=2018.25,freq=4),lwd=2,col="blue")
ts.plot(ts_hosr,main="Log Forecasts:ARIMAX",ylab="homeownership rate",ylim=c(62,69))
lines(ts(exp(m_arimax_log_pred.pred),start=2018.25,freq=4),lwd=3,col="green")
lines(ts(exp(m_arimax_log_pred.ubound),start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(exp(m_arimax_log_pred.lbound),start=2018.25,freq=4),lwd=3,col="blue")
cat("\ngam_arma_org MAPE:",mean(abs(m_gam_arma_org.pred-testing$hosr)/testing$hosr),
"\ngam_arma_org PM:",sum((m_gam_arma_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\ngam_arma_log MAPE:",mean(abs(m_gam_arma_log.pred-testing$hosr)/testing$hosr),
"\ngam_arma_log PM:",sum((m_gam_arma_log.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_var_org MAPE:",mean(abs(m_var_org.pred-testing$hosr)/testing$hosr),
"\nm_var_org PM:",sum((m_var_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_var_log MAPE:",mean(abs(m_var_log.pred-testing$hosr)/testing$hosr),
"\nm_var_log PM:",sum((m_var_log.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_rs_var_org MAPE:",mean(abs(m_rs_var_org.pred-testing$hosr)/testing$hosr),
"\nm_rs_var_org PM:",sum((m_rs_var_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_rs_var_log MAPE:",mean(abs(m_rs_var_log.pred-testing$hosr)/testing$hosr),
"\nm_rs_var_log PM:",sum((m_rs_var_log.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_varx_org MAPE:",mean(abs(m_varx_org.pred-testing$hosr)/testing$hosr),
"\nm_varx_org PM:",sum((m_varx_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_rs_varx_org MAPE:",mean(abs(m_rs_varx_org.pred-testing$hosr)/testing$hosr),
"\nm_rs_varx_org PM:",sum((m_rs_varx_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_arima_ori MAPE:",mean(abs((m_arima_ori_pred.pred)/testing$hosr)),
"\nm_arima_ori PM:",sum(((m_arima_ori_pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)),
"\nm_arima_log MAPE:",mean(abs((m_arima_log_pred.pred)/testing$hosr)),
"\nm_arima_log PM:",sum(((m_arima_log_pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)),
"\nm_arimax_ori MAPE:",mean(abs((m_arimax_ori_pred.pred)/testing$hosr)),
"\nm_arimax_ori PM:",sum(((m_arimax_ori_pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)),
"\nm_arimax_log MAPE:",mean(abs((m_arimax_log_pred.pred)/testing$hosr)),
"\nm_arimax_log PM:",sum(((m_arimax_log_pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)))
## Combined Forecast Plot
ts.plot(ts_hosr,main="All Forecasts",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_gam_arma_org.pred,start=2018.25,freq=4),lwd=2,col="red")
lines(ts(m_gam_arma_log.pred,start=2018.25,freq=4),lwd=2,col="orange")
lines(ts(m_var_org.pred,start=2018.25,freq=4),lwd=2,col="blue")
lines(ts(m_rs_var_org.pred,start=2018.25,freq=4),lwd=2,col="lightblue")
lines(ts(m_var_log.pred,start=2018.25,freq=4),lwd=2,col="darkgreen")
lines(ts(m_rs_var_log.pred,start=2018.25,freq=4),lwd=2,col="green")
lines(ts(m_varx_org.pred,start=2018.25,freq=4),lwd=2,col="lightgreen")
lines(ts(m_rs_varx_org.pred,start=2018.25,freq=4),lwd=2,col="pink")
lines(ts(m_arima_ori_pred.pred,start=2018.25,freq=4),lwd=2,col="yellow")
lines(ts(m_arima_log_pred.pred,start=2018.25,freq=4),lwd=2,col="grey")
lines(ts(m_arimax_ori_pred.pred,start=2018.25,freq=4),lwd=2,col="darkblue")
lines(ts(m_arimax_log_pred.pred,start=2018.25,freq=4),lwd=2,col="darkred")
legend(x=1980,y=69,legend=c("gam_arma_o","gam_arma_l","var_o","rs_var_o","var_l","rs_var_l","varx_o","rs_varx_o","arima_o","arima_l","arimax_o","arimax_l"),pch=1,
pt.lwd = 2, col=c("red","orange","blue","lightblue","darkgreen","green","lightgreen","pink","yellow","grey","darkblue","darkred"))
## Individual Plots
par(mfrow=c(3, 2))
##Trend Estimation + ARMA
ts.plot(ts_hosr,main="Org Forecast:spline Trend + ARMA",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_gam_arma_org.pred,start=2018.25,freq=4),lwd=2,col="red")
lines(ts(m_gam_arma_org.ubound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_gam_arma_org.lbound,start=2018.25,freq=4),lwd=3,col="blue")
ts.plot(ts_hosr,main="Log Forecast:spline Trend + ARMA",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_gam_arma_log.pred,start=2018.25,freq=4),lwd=2,col="green")
lines(ts(m_gam_arma_log.ubound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_gam_arma_log.lbound,start=2018.25,freq=4),lwd=3,col="blue")
## VAR Ori
ts.plot(ts_hosr,main="Ori Forecast:Unrestrict VAR",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_var_org.pred,start=2018.25,freq=4),lwd=2,col="red")
lines(ts(m_var_org.pred.lbound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_var_org.pred.ubound,start=2018.25,freq=4),lwd=3,col="blue")
ts.plot(ts_hosr,main="Ori Forecast:Restrict VAR",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_rs_var_org.pred,start=2018.25,freq=4),lwd=2,col="green")
lines(ts(m_rs_var_org.pred.lbound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_rs_var_org.pred.ubound,start=2018.25,freq=4),lwd=3,col="blue")
##VAR Log
ts.plot(ts_hosr,main="Log Forecast:Unrestrict VAR",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_var_log.pred,start=2018.25,freq=4),lwd=2,col="red")
lines(ts(m_var_log.pred.lbound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_var_log.pred.ubound,start=2018.25,freq=4),lwd=3,col="blue")
ts.plot(ts_hosr,main="Log Forecast:Restrict VAR",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_rs_var_log.pred,start=2018.25,freq=4),lwd=2,col="green")
lines(ts(m_rs_var_log.pred.lbound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_rs_var_log.pred.ubound,start=2018.25,freq=4),lwd=3,col="blue")
par(mfrow=c(3, 2))
## VARX
ts.plot(ts_hosr,main="Ori Forecast:Unrestrict VARX",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_varx_org.pred,start=2018.25,freq=4),lwd=2,col="red")
lines(ts(m_varx_org.pred.lbound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_varx_org.pred.ubound,start=2018.25,freq=4),lwd=3,col="blue")
ts.plot(ts_hosr,main="Ori Forecast:Restrict VARX",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_rs_var_log.pred,start=2018.25,freq=4),lwd=2,col="green")
lines(ts(m_rs_var_log.pred.lbound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_rs_var_log.pred.ubound,start=2018.25,freq=4),lwd=3,col="blue")
##ARIMA
ts.plot(ts_hosr,main="Ori Forecasts:ARIMA",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_arima_ori_pred.pred,start=2018.25,freq=4),lwd=2,col="red")
lines(ts(m_arima_ori_pred.ubound,start=2018.25,freq=4),lwd=2,col="blue")
lines(ts(m_arima_ori_pred.lbound,start=2018.25,freq=4),lwd=2,col="blue")
ts.plot(ts_hosr,main="Log Forecasts:ARIMA",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_arima_log_pred.pred,start=2018.25,freq=4),lwd=3,col="green")
lines(ts(m_arima_log_pred.ubound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_arima_log_pred.lbound,start=2018.25,freq=4),lwd=3,col="blue")
##ARIMAX
ts.plot(ts_hosr,main="Ori Forecasts:ARIMAX",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_arimax_ori_pred.pred,start=2018.25,freq=4),lwd=2,col="red")
lines(ts(m_arimax_ori_pred.ubound,start=2018.25,freq=4),lwd=2,col="blue")
lines(ts(m_arimax_ori_pred.lbound,start=2018.25,freq=4),lwd=2,col="blue")
ts.plot(ts_hosr,main="Log Forecasts:ARIMAX",ylab="homeownership rate",ylim=c(62,69))
lines(ts(exp(m_arimax_log_pred.pred),start=2018.25,freq=4),lwd=3,col="green")
lines(ts(exp(m_arimax_log_pred.ubound),start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(exp(m_arimax_log_pred.lbound),start=2018.25,freq=4),lwd=3,col="blue")
m_arimax_ori_pred.pred = data.frame(m_arimax_ori_pred)[,"Point.Forecast"]
m_arimax_ori_pred.ubound = data.frame(m_arimax_ori_pred)[, "Hi.95"]
m_arimax_ori_pred.lbound = data.frame(m_arimax_ori_pred)[, "Lo.95"]
m_arimax_log_pred.pred = exp(data.frame(m_arimax_log_pred)[,"Point.Forecast"])
m_arimax_log_pred.ubound = exp(data.frame(m_arimax_log_pred)[, "Hi.95"])
m_arimax_log_pred.lbound = exp(data.frame(m_arimax_log_pred)[, "Lo.95"])
## Combined Forecast Plot
ts.plot(ts_hosr,main="All Forecasts",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_gam_arma_org.pred,start=2018.25,freq=4),lwd=2,col="red")
lines(ts(m_gam_arma_log.pred,start=2018.25,freq=4),lwd=2,col="orange")
lines(ts(m_var_org.pred,start=2018.25,freq=4),lwd=2,col="blue")
lines(ts(m_rs_var_org.pred,start=2018.25,freq=4),lwd=2,col="lightblue")
lines(ts(m_var_log.pred,start=2018.25,freq=4),lwd=2,col="darkgreen")
lines(ts(m_rs_var_log.pred,start=2018.25,freq=4),lwd=2,col="green")
lines(ts(m_varx_org.pred,start=2018.25,freq=4),lwd=2,col="lightgreen")
lines(ts(m_rs_varx_org.pred,start=2018.25,freq=4),lwd=2,col="pink")
lines(ts(m_arima_ori_pred.pred,start=2018.25,freq=4),lwd=2,col="yellow")
lines(ts(m_arima_log_pred.pred,start=2018.25,freq=4),lwd=2,col="grey")
lines(ts(m_arimax_ori_pred.pred,start=2018.25,freq=4),lwd=2,col="darkblue")
lines(ts(m_arimax_log_pred.pred,start=2018.25,freq=4),lwd=2,col="darkred")
legend(x=1980,y=69,legend=c("gam_arma_o","gam_arma_l","var_o","rs_var_o","var_l","rs_var_l","varx_o","rs_varx_o","arima_o","arima_l","arimax_o","arimax_l"),pch=1,
pt.lwd = 2, col=c("red","orange","blue","lightblue","darkgreen","green","lightgreen","pink","yellow","grey","darkblue","darkred"))
## Individual Plots
par(mfrow=c(3, 2))
##Trend Estimation + ARMA
ts.plot(ts_hosr,main="Org Forecast:spline Trend + ARMA",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_gam_arma_org.pred,start=2018.25,freq=4),lwd=2,col="red")
lines(ts(m_gam_arma_org.ubound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_gam_arma_org.lbound,start=2018.25,freq=4),lwd=3,col="blue")
ts.plot(ts_hosr,main="Log Forecast:spline Trend + ARMA",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_gam_arma_log.pred,start=2018.25,freq=4),lwd=2,col="green")
lines(ts(m_gam_arma_log.ubound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_gam_arma_log.lbound,start=2018.25,freq=4),lwd=3,col="blue")
## VAR Ori
ts.plot(ts_hosr,main="Ori Forecast:Unrestrict VAR",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_var_org.pred,start=2018.25,freq=4),lwd=2,col="red")
lines(ts(m_var_org.pred.lbound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_var_org.pred.ubound,start=2018.25,freq=4),lwd=3,col="blue")
ts.plot(ts_hosr,main="Ori Forecast:Restrict VAR",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_rs_var_org.pred,start=2018.25,freq=4),lwd=2,col="green")
lines(ts(m_rs_var_org.pred.lbound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_rs_var_org.pred.ubound,start=2018.25,freq=4),lwd=3,col="blue")
##VAR Log
ts.plot(ts_hosr,main="Log Forecast:Unrestrict VAR",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_var_log.pred,start=2018.25,freq=4),lwd=2,col="red")
lines(ts(m_var_log.pred.lbound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_var_log.pred.ubound,start=2018.25,freq=4),lwd=3,col="blue")
ts.plot(ts_hosr,main="Log Forecast:Restrict VAR",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_rs_var_log.pred,start=2018.25,freq=4),lwd=2,col="green")
lines(ts(m_rs_var_log.pred.lbound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_rs_var_log.pred.ubound,start=2018.25,freq=4),lwd=3,col="blue")
par(mfrow=c(3, 2))
## VARX
ts.plot(ts_hosr,main="Ori Forecast:Unrestrict VARX",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_varx_org.pred,start=2018.25,freq=4),lwd=2,col="red")
lines(ts(m_varx_org.pred.lbound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_varx_org.pred.ubound,start=2018.25,freq=4),lwd=3,col="blue")
ts.plot(ts_hosr,main="Ori Forecast:Restrict VARX",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_rs_var_log.pred,start=2018.25,freq=4),lwd=2,col="green")
lines(ts(m_rs_var_log.pred.lbound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_rs_var_log.pred.ubound,start=2018.25,freq=4),lwd=3,col="blue")
##ARIMA
ts.plot(ts_hosr,main="Ori Forecasts:ARIMA",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_arima_ori_pred.pred,start=2018.25,freq=4),lwd=2,col="red")
lines(ts(m_arima_ori_pred.ubound,start=2018.25,freq=4),lwd=2,col="blue")
lines(ts(m_arima_ori_pred.lbound,start=2018.25,freq=4),lwd=2,col="blue")
ts.plot(ts_hosr,main="Log Forecasts:ARIMA",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_arima_log_pred.pred,start=2018.25,freq=4),lwd=3,col="green")
lines(ts(m_arima_log_pred.ubound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_arima_log_pred.lbound,start=2018.25,freq=4),lwd=3,col="blue")
##ARIMAX
ts.plot(ts_hosr,main="Ori Forecasts:ARIMAX",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_arimax_ori_pred.pred,start=2018.25,freq=4),lwd=2,col="red")
lines(ts(m_arimax_ori_pred.ubound,start=2018.25,freq=4),lwd=2,col="blue")
lines(ts(m_arimax_ori_pred.lbound,start=2018.25,freq=4),lwd=2,col="blue")
ts.plot(ts_hosr,main="Log Forecasts:ARIMAX",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_arimax_log_pred.pred,start=2018.25,freq=4),lwd=3,col="green")
lines(ts(m_arimax_log_pred.ubound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_arimax_log_pred.lbound,start=2018.25,freq=4),lwd=3,col="blue")
##ARIMAX
ts.plot(ts_hosr,main="Ori Forecasts:ARIMAX",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_arimax_ori_pred.pred,start=2018.25,freq=4),lwd=2,col="red")
lines(ts(m_arimax_ori_pred.ubound,start=2018.25,freq=4),lwd=2,col="blue")
lines(ts(m_arimax_ori_pred.lbound,start=2018.25,freq=4),lwd=2,col="blue")
##ARIMAX
ts.plot(ts_hosr,main="Ori Forecasts:ARIMAX",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_arimax_ori_pred.pred,start=2018.25,freq=4),lwd=2,col="red")
lines(ts(m_arimax_ori_pred.ubound,start=2018.25,freq=4),lwd=2,col="blue")
lines(ts(m_arimax_ori_pred.lbound,start=2018.25,freq=4),lwd=2,col="blue")
##VAR Log
ts.plot(ts_hosr,main="Log Forecast:Unrestrict VAR",ylab="homeownership rate",ylim=c(62,69))
lines(ts(m_var_log.pred,start=2018.25,freq=4),lwd=2,col="red")
lines(ts(m_var_log.pred.lbound,start=2018.25,freq=4),lwd=3,col="blue")
lines(ts(m_var_log.pred.ubound,start=2018.25,freq=4),lwd=3,col="blue")
cat("\ngam_arma_org MAPE:",mean(abs(m_gam_arma_org.pred-testing$hosr)/testing$hosr),
"\ngam_arma_org PM:",sum((m_gam_arma_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\ngam_arma_log MAPE:",mean(abs(m_gam_arma_log.pred-testing$hosr)/testing$hosr),
"\ngam_arma_log PM:",sum((m_gam_arma_log.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_var_org MAPE:",mean(abs(m_var_org.pred-testing$hosr)/testing$hosr),
"\nm_var_org PM:",sum((m_var_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_var_log MAPE:",mean(abs(m_var_log.pred-testing$hosr)/testing$hosr),
"\nm_var_log PM:",sum((m_var_log.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_rs_var_org MAPE:",mean(abs(m_rs_var_org.pred-testing$hosr)/testing$hosr),
"\nm_rs_var_org PM:",sum((m_rs_var_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_rs_var_log MAPE:",mean(abs(m_rs_var_log.pred-testing$hosr)/testing$hosr),
"\nm_rs_var_log PM:",sum((m_rs_var_log.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_varx_org MAPE:",mean(abs(m_varx_org.pred-testing$hosr)/testing$hosr),
"\nm_varx_org PM:",sum((m_varx_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_rs_varx_org MAPE:",mean(abs(m_rs_varx_org.pred-testing$hosr)/testing$hosr),
"\nm_rs_varx_org PM:",sum((m_rs_varx_org.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2),
"\nm_arima_ori MAPE:",mean(abs((m_arima_ori_pred.pred)/testing$hosr)),
"\nm_arima_ori PM:",sum(((m_arima_ori_pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)),
"\nm_arima_log MAPE:",mean(abs((m_arima_log_pred.pred)/testing$hosr)),
"\nm_arima_log PM:",sum(((m_arima_log_pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)),
"\nm_arimax_ori MAPE:",mean(abs((m_arimax_ori_pred.pred)/testing$hosr)),
"\nm_arimax_ori PM:",sum(((m_arimax_ori_pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)),
"\nm_arimax_log MAPE:",mean(abs((m_arimax_log_pred.pred)/testing$hosr)),
"\nm_arimax_log PM:",sum(((m_arimax_log_pred.pred-testing$hosr)^2)/sum((testing$hosr-mean(testing$hosr))^2)))
